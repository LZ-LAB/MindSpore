# -- coding: utf-8 --
# @Time: 2022-04-28 15:06
# @Author: WangCx
# @File: last_model
# @Project: HypergraphNN_test2
from tqdm import tqdm
import random
import math
import mindspore
import mindspore.nn as nn
import x2ms_adapter
import x2ms_adapter.torch_api.nn_api.nn as x2ms_nn


class BaseClass(nn.Cell):
    def __init__(self):
        super(BaseClass, self).__init__()
        self.cur_itr = mindspore.Parameter(x2ms_adapter.x2ms_tensor(0, dtype=mindspore.int32), requires_grad=False)
        self.best_mrr = mindspore.Parameter(x2ms_adapter.x2ms_tensor(0, dtype=mindspore.float64), requires_grad=False)
        self.best_itr = mindspore.Parameter(x2ms_adapter.x2ms_tensor(0, dtype=mindspore.int32), requires_grad=False)


class HyperNet(BaseClass):
    def __init__(self, dataset, emb_dim, hidden_drop):
        super(HyperNet, self).__init__()
        self.emb_dim = emb_dim
        self.dataset = dataset
        self.E = x2ms_nn.Embedding(dataset.num_ent, emb_dim, padding_idx=0)
        self.R = x2ms_nn.Embedding(dataset.num_rel, emb_dim, padding_idx=0)
        self.W0 = mindspore.Parameter(x2ms_adapter.empty(size=(3*emb_dim, 300)))
        self.W1 = mindspore.Parameter(x2ms_adapter.empty(size=(2*emb_dim, 300)))
        self.W2 = mindspore.Parameter(x2ms_adapter.empty(size=(emb_dim, 300)))
        self.W3 = mindspore.Parameter(x2ms_adapter.empty(size=(emb_dim, 300)))
        self.a = mindspore.Parameter(x2ms_adapter.empty(size=(300, 1)))
        self.a2 = mindspore.Parameter(x2ms_adapter.empty(size=(300, 1)))
        x2ms_adapter.nn_init.xavier_normal_(self.E.weight.data)
        x2ms_adapter.nn_init.xavier_normal_(self.R.weight.data)
        x2ms_adapter.nn_init.xavier_normal_(self.W0.data)
        x2ms_adapter.nn_init.xavier_normal_(self.a.data)
        x2ms_adapter.nn_init.xavier_normal_(self.a2.data)
        x2ms_adapter.nn_init.xavier_normal_(self.W1.data)
        x2ms_adapter.nn_init.xavier_normal_(self.W2.data)
        x2ms_adapter.nn_init.xavier_normal_(self.W3.data)
        self.hidden_drop_rate = hidden_drop
        self.hidden_drop = x2ms_nn.Dropout(self.hidden_drop_rate)
        self.leakyrelu = x2ms_nn.LeakyReLU(0.2)


        self.in_channels = 1
        self.out_channels = 5
        self.filt_h = 1
        self.filt_w = 1
        self.stride = 2

        self.max_arity = 5


        self.bn0 = x2ms_nn.BatchNorm2d(self.in_channels)
        self.inp_drop = x2ms_nn.Dropout(0.2)

        fc_length = (1-self.filt_h+1)*x2ms_adapter.tensor_api.floor(math, (emb_dim-self.filt_w)/self.stride + 1)*self.out_channels

        self.bn2 = x2ms_nn.BatchNorm1d(fc_length)
        # Projection network
        self.fc = x2ms_nn.Linear(fc_length, emb_dim)
        self.device = x2ms_adapter.Device('cuda:0' if x2ms_adapter.is_cuda_available() else 'cpu')

        # size of the convolution filters outputted by the hypernetwork
        fc1_length = self.in_channels*self.out_channels*self.filt_h*self.filt_w
        # Hypernetwork
        self.fc1 = x2ms_nn.Linear(emb_dim + self.max_arity + 1, fc1_length) # (306, 5)
        self.fc2 = x2ms_nn.Linear(self.max_arity + 1, fc1_length) # (6, 5)


    def er_pos_emb(self, r_emb, e_emb):
        return x2ms_adapter.mm(x2ms_adapter.cat((r_emb, e_emb), dim=1), self.W1)


    def convolve(self, r, ei, pos):

        e = x2ms_adapter.tensor_api.view(ei, -1, 1, 1, x2ms_adapter.tensor_api.x2ms_size(self.E.weight, 1))
        x = e
        x = self.inp_drop(x)
        one_hot_target = x2ms_adapter.to(x2ms_adapter.tensor_api.x2ms_float((pos == x2ms_adapter.arange(self.max_arity + 1).reshape(self.max_arity + 1))), self.device)
        poses = x2ms_adapter.tensor_api.view(x2ms_adapter.tensor_api.repeat(one_hot_target, r.shape[0]), -1, self.max_arity + 1)
        one_hot_target.requires_grad = False
        poses.requires_grad = False
        k = self.fc2(poses)
        k = x2ms_adapter.tensor_api.view(k, -1, self.in_channels, self.out_channels, self.filt_h, self.filt_w)
        k = x2ms_adapter.tensor_api.view(k, x2ms_adapter.tensor_api.x2ms_size(e, 0)*self.in_channels*self.out_channels, 1, self.filt_h, self.filt_w)
        x = x2ms_adapter.tensor_api.permute(x, 1, 0, 2, 3)
        x = x2ms_adapter.nn_functional.conv2d(x, k, stride=self.stride, groups=x2ms_adapter.tensor_api.x2ms_size(e, 0))
        x = x2ms_adapter.tensor_api.view(x, x2ms_adapter.tensor_api.x2ms_size(e, 0), 1, self.out_channels, 1-self.filt_h+1, -1)
        x = x2ms_adapter.tensor_api.permute(x, 0, 3, 4, 1, 2)
        x = x2ms_adapter.x2ms_sum(x, dim=3)
        x = x2ms_adapter.tensor_api.contiguous(x2ms_adapter.tensor_api.permute(x, 0, 3, 1, 2))
        x = x2ms_adapter.tensor_api.view(x, x2ms_adapter.tensor_api.x2ms_size(e, 0), -1)
        x = self.fc(x)
        return x

    def construct(self, batch, ms, bs):
        r_idx = batch[:, 0]
        r = self.R(r_idx)

        if batch.shape[1] == 3:
            # e1 = self.convolve(r, self.E(batch[:, 1]), 0)*ms[:, 0].view(-1, 1) + bs[:, 0].view(-1, 1)
            # e2 = self.convolve(r, self.E(batch[:, 2]), 1)*ms[:, 1].view(-1, 1) + bs[:, 1].view(-1, 1)
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * x2ms_adapter.tensor_api.view(ms[:,0], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,0], -1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * x2ms_adapter.tensor_api.view(ms[:,1], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,1], -1, 1)

            e12 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e2, r), dim=1), self.W0)
            e21 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e1, r), dim=1), self.W0)

            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) / x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a)))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) / x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a)))
            # e1 = self.linear(torch.cat((e1, torch.tanh(e2*e1_e2_att)), dim=1))
            # e2 = self.linear(torch.cat((e2, torch.tanh(e1*e2_e1_att)), dim=1))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att)), dim=1), self.W0)

            new_e1 = x2ms_adapter.mm(e1, self.W2) + x2ms_adapter.tanh(e12*e1_e2_att)
            new_e2 = x2ms_adapter.mm(e2, self.W2) + x2ms_adapter.tanh(e21*e2_e1_att)

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))))
            re2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))))


            r = x2ms_adapter.mm(r, self.W3) + x2ms_adapter.tanh(re1*x2ms_adapter.tensor_api.view(re1_att, -1, 1) + re2*x2ms_adapter.tensor_api.view(re2_att, -1, 1))


            e = new_e1 * new_e2 * r

        elif batch.shape[1] == 4:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * x2ms_adapter.tensor_api.view(ms[:,0], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,0], -1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * x2ms_adapter.tensor_api.view(ms[:,1], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,1], -1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * x2ms_adapter.tensor_api.view(ms[:,2], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,2], -1, 1)
            e12 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e2, r), dim=1), self.W0)
            e13 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e3, r), dim=1), self.W0)
            e21 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e1, r), dim=1), self.W0)
            e23 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e3, r), dim=1), self.W0)
            e31 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e1, r), dim=1), self.W0)
            e32 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e2, r), dim=1), self.W0)

            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))))


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)

            re1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))))
            re2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))))
            re3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))))


            r = x2ms_adapter.mm(r, self.W3) + x2ms_adapter.tanh(re1*x2ms_adapter.tensor_api.view(re1_att, -1, 1) + re2*x2ms_adapter.tensor_api.view(re2_att, -1, 1) + re3*x2ms_adapter.tensor_api.view(re3_att, -1, 1))
            new_e1 = x2ms_adapter.mm(e1, self.W2) + x2ms_adapter.tanh(e12*e1_e2_att + e13*e1_e3_att)
            new_e2 = x2ms_adapter.mm(e2, self.W2) + x2ms_adapter.tanh(e21*e2_e1_att + e23*e2_e3_att)
            new_e3 = x2ms_adapter.mm(e3, self.W2) + x2ms_adapter.tanh(e31*e3_e1_att + e32*e3_e2_att)
            # e1 = torch.mm(torch.cat((e1, (e2*e1_e2_att + e3*e1_e3_att)), dim=1), self.W0)
            # e2 = torch.mm(torch.cat((e2, (e1*e2_e1_att + e3*e2_e3_att)), dim=1), self.W0)
            # e3 = torch.mm(torch.cat((e3, (e1*e3_e1_att + e2*e3_e2_att)), dim=1), self.W0)

            e = new_e1 * new_e2 * new_e3 * r

        elif batch.shape[1] == 5:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * x2ms_adapter.tensor_api.view(ms[:,0], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,0], -1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * x2ms_adapter.tensor_api.view(ms[:,1], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,1], -1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * x2ms_adapter.tensor_api.view(ms[:,2], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,2], -1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * x2ms_adapter.tensor_api.view(ms[:,3], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,3], -1, 1)


            e12 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e2, r), dim=1), self.W0)
            e13 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e3, r), dim=1), self.W0)
            e14 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e4, r), dim=1), self.W0)
            e21 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e1, r), dim=1), self.W0)
            e23 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e3, r), dim=1), self.W0)
            e24 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e4, r), dim=1), self.W0)
            e31 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e1, r), dim=1), self.W0)
            e32 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e2, r), dim=1), self.W0)
            e34 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e4, r), dim=1), self.W0)
            e41 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e1, r), dim=1), self.W0)
            e42 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e2, r), dim=1), self.W0)
            e43 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e3, r), dim=1), self.W0)

            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))))

            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att)), dim=1), self.W0)
            new_e1 = x2ms_adapter.mm(e1, self.W2) + x2ms_adapter.tanh(e12 * e1_e2_att + e13 * e1_e3_att + e14 * e1_e4_att)
            new_e2 = x2ms_adapter.mm(e2, self.W2) + x2ms_adapter.tanh(e21 * e2_e1_att + e23 * e2_e3_att + e24 * e2_e4_att)
            new_e3 = x2ms_adapter.mm(e3, self.W2) + x2ms_adapter.tanh(e31 * e3_e1_att + e32 * e3_e2_att + e34 * e3_e4_att)
            new_e4 = x2ms_adapter.mm(e4, self.W2) + x2ms_adapter.tanh(e41 * e4_e1_att + e42 * e4_e2_att + e43 * e4_e3_att)

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))))
            re2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))))
            re3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))))
            re4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))))

            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)))
            r = x2ms_adapter.mm(r, self.W3) + x2ms_adapter.tanh(re1*x2ms_adapter.tensor_api.view(re1_att, -1, 1) + re2*x2ms_adapter.tensor_api.view(re2_att, -1, 1) + re3*x2ms_adapter.tensor_api.view(re3_att, -1, 1) + re4*x2ms_adapter.tensor_api.view(re4_att, -1, 1))


            e = new_e1 * new_e2 * new_e3 * new_e4 * r


        elif batch.shape[1] == 6:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * x2ms_adapter.tensor_api.view(ms[:,0], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,0], -1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * x2ms_adapter.tensor_api.view(ms[:,1], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,1], -1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * x2ms_adapter.tensor_api.view(ms[:,2], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,2], -1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * x2ms_adapter.tensor_api.view(ms[:,3], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,3], -1, 1)
            e5 = self.convolve(r, self.E(batch[:, 5]), 4) * x2ms_adapter.tensor_api.view(ms[:,4], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,4], -1, 1)

            e12 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e2, r), dim=1), self.W0)
            e13 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e3, r), dim=1), self.W0)
            e14 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e4, r), dim=1), self.W0)
            e15 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e5, r), dim=1), self.W0)
            e21 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e1, r), dim=1), self.W0)
            e23 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e3, r), dim=1), self.W0)
            e24 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e4, r), dim=1), self.W0)
            e25 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e5, r), dim=1), self.W0)
            e31 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e1, r), dim=1), self.W0)
            e32 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e2, r), dim=1), self.W0)
            e34 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e4, r), dim=1), self.W0)
            e35 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e5, r), dim=1), self.W0)
            e41 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e1, r), dim=1), self.W0)
            e42 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e2, r), dim=1), self.W0)
            e43 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e3, r), dim=1), self.W0)
            e45 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e5, r), dim=1), self.W0)
            e51 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e1, r), dim=1), self.W0)
            e52 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e2, r), dim=1), self.W0)
            e53 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e3, r), dim=1), self.W0)
            e54 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e4, r), dim=1), self.W0)



            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))))
            e1_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))))
            e2_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))))
            e3_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))))
            e4_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))))
            e5_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))))
            e5_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))))
            e5_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))))
            e5_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))))

            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att
            re1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))))
            re2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))))
            re3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))))
            re4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))))
            re5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))))

            r = x2ms_adapter.mm(r, self.W3) + x2ms_adapter.tanh(re1*x2ms_adapter.tensor_api.view(re1_att, -1, 1) + re2*x2ms_adapter.tensor_api.view(re2_att, -1, 1) + re3*x2ms_adapter.tensor_api.view(re3_att, -1, 1) + re4*x2ms_adapter.tensor_api.view(re4_att, -1, 1) + re5*x2ms_adapter.tensor_api.view(re5_att, -1, 1))


            # new_e1 = torch.mm(torch.cat((e1, (z2*e1_e2_att + z3*e1_e3_att + z4*e1_e4_att + z5*e1_e5_att)), dim=1), self.W0)
            # new_e2 = torch.mm(torch.cat((e2, (z1*e2_e1_att + z3*e2_e3_att + z4*e2_e4_att + z5*e2_e5_att)), dim=1), self.W0)
            # new_e3 = torch.mm(torch.cat((e3, (z1*e3_e1_att + z2*e3_e2_att + z4*e3_e4_att + z5*e3_e5_att)), dim=1), self.W0)
            # new_e4 = torch.mm(torch.cat((e4, (z1*e4_e1_att + z2*e4_e2_att + z3*e4_e3_att + z5*e4_e5_att)), dim=1), self.W0)
            # new_e5 = torch.mm(torch.cat((e5, (z1*e5_e1_att + z2*e5_e2_att + z3*e5_e3_att + z4*e5_e4_att)), dim=1), self.W0)
            new_e1 = x2ms_adapter.mm(e1, self.W2) + x2ms_adapter.tanh(e12*e1_e2_att + e13*e1_e3_att + e14*e1_e4_att + e15*e1_e5_att)
            new_e2 = x2ms_adapter.mm(e2, self.W2) + x2ms_adapter.tanh(e21*e2_e1_att + e23*e2_e3_att + e24*e2_e4_att + e25*e2_e5_att)
            new_e3 = x2ms_adapter.mm(e3, self.W2) + x2ms_adapter.tanh(e31*e3_e1_att + e32*e3_e2_att + e34*e3_e4_att + e35*e3_e5_att)
            new_e4 = x2ms_adapter.mm(e4, self.W2) + x2ms_adapter.tanh(e41*e4_e1_att + e42*e4_e2_att + e43*e4_e3_att + e45*e4_e5_att)
            new_e5 = x2ms_adapter.mm(e5, self.W2) + x2ms_adapter.tanh(e51*e5_e1_att + e52*e5_e2_att + e53*e5_e3_att + e54*e5_e4_att)

            e = new_e1 * new_e2 * new_e3 * new_e4 * new_e5 * r

        elif batch.shape[1] == 7:
            e1 = self.convolve(r, self.E(batch[:, 1]), 0) * x2ms_adapter.tensor_api.view(ms[:,0], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,0], -1, 1)
            e2 = self.convolve(r, self.E(batch[:, 2]), 1) * x2ms_adapter.tensor_api.view(ms[:,1], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,1], -1, 1)
            e3 = self.convolve(r, self.E(batch[:, 3]), 2) * x2ms_adapter.tensor_api.view(ms[:,2], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,2], -1, 1)
            e4 = self.convolve(r, self.E(batch[:, 4]), 3) * x2ms_adapter.tensor_api.view(ms[:,3], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,3], -1, 1)
            e5 = self.convolve(r, self.E(batch[:, 5]), 4) * x2ms_adapter.tensor_api.view(ms[:,4], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,4], -1, 1)
            e6 = self.convolve(r, self.E(batch[:, 6]), 5) * x2ms_adapter.tensor_api.view(ms[:,5], -1, 1) + x2ms_adapter.tensor_api.view(bs[:,5], -1, 1)

            e12 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e2, r), dim=1), self.W0)
            e13 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e3, r), dim=1), self.W0)
            e14 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e4, r), dim=1), self.W0)
            e15 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e5, r), dim=1), self.W0)
            e16 = x2ms_adapter.mm(x2ms_adapter.cat((e1, e6, r), dim=1), self.W0)
            e21 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e1, r), dim=1), self.W0)
            e23 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e3, r), dim=1), self.W0)
            e24 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e4, r), dim=1), self.W0)
            e25 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e5, r), dim=1), self.W0)
            e26 = x2ms_adapter.mm(x2ms_adapter.cat((e2, e6, r), dim=1), self.W0)
            e31 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e1, r), dim=1), self.W0)
            e32 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e2, r), dim=1), self.W0)
            e34 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e4, r), dim=1), self.W0)
            e35 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e5, r), dim=1), self.W0)
            e36 = x2ms_adapter.mm(x2ms_adapter.cat((e3, e6, r), dim=1), self.W0)
            e41 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e1, r), dim=1), self.W0)
            e42 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e2, r), dim=1), self.W0)
            e43 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e3, r), dim=1), self.W0)
            e45 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e5, r), dim=1), self.W0)
            e46 = x2ms_adapter.mm(x2ms_adapter.cat((e4, e6, r), dim=1), self.W0)
            e51 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e1, r), dim=1), self.W0)
            e52 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e2, r), dim=1), self.W0)
            e53 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e3, r), dim=1), self.W0)
            e54 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e4, r), dim=1), self.W0)
            e56 = x2ms_adapter.mm(x2ms_adapter.cat((e5, e6, r), dim=1), self.W0)
            e61 = x2ms_adapter.mm(x2ms_adapter.cat((e6, e1, r), dim=1), self.W0)
            e62 = x2ms_adapter.mm(x2ms_adapter.cat((e6, e2, r), dim=1), self.W0)
            e63 = x2ms_adapter.mm(x2ms_adapter.cat((e6, e3, r), dim=1), self.W0)
            e64 = x2ms_adapter.mm(x2ms_adapter.cat((e6, e4, r), dim=1), self.W0)
            e65 = x2ms_adapter.mm(x2ms_adapter.cat((e6, e5, r), dim=1), self.W0)

            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))))
            e1_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))))
            e1_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e12, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e13, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e14, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e15, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e16, self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))))
            e2_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))))
            e2_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e21, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e23, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e24, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e25, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e26, self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))))
            e3_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))))
            e3_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e31, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e32, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e34, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e35, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e36, self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))))
            e4_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))))
            e4_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e41, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e42, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e43, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e45, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e46, self.a))))
            e5_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))))
            e5_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))))
            e5_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))))
            e5_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))))
            e5_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e51, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e52, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e53, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e54, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e56, self.a))))
            e6_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))))
            e6_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))))
            e6_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))))
            e6_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))))
            e6_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e61, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e62, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e63, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e64, self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(e65, self.a))))


            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            # re1_att = torch.exp(self.leakyrelu(re1)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re2_att = torch.exp(self.leakyrelu(re2)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re3_att = torch.exp(self.leakyrelu(re3)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re4_att = torch.exp(self.leakyrelu(re4)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # re5_att = torch.exp(self.leakyrelu(re5)) / (torch.exp(self.leakyrelu(re1)) + torch.exp(self.leakyrelu(re2)) + torch.exp(self.leakyrelu(re3)) + torch.exp(self.leakyrelu(re4)) + torch.exp(self.leakyrelu(re5)))
            # r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att
            re1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))
            re2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))
            re3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))
            re4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))
            re5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))
            re6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re1, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re2, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re3, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re4, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re5, self.a2))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(re6, self.a2))))

            r = x2ms_adapter.mm(r, self.W3) + x2ms_adapter.tanh(re1*x2ms_adapter.tensor_api.view(re1_att, -1, 1) + re2*x2ms_adapter.tensor_api.view(re2_att, -1, 1) + re3*x2ms_adapter.tensor_api.view(re3_att, -1, 1) + re4*x2ms_adapter.tensor_api.view(re4_att, -1, 1) + re5*x2ms_adapter.tensor_api.view(re5_att, -1, 1) + re6*x2ms_adapter.tensor_api.view(re6_att, -1, 1))


            new_e1 = x2ms_adapter.mm(e1, self.W2) + x2ms_adapter.tanh(e12*e1_e2_att + e13*e1_e3_att + e14*e1_e4_att + e15*e1_e5_att + e16*e1_e6_att)
            new_e2 = x2ms_adapter.mm(e2, self.W2) + x2ms_adapter.tanh(e21*e2_e1_att + e23*e2_e3_att + e24*e2_e4_att + e25*e2_e5_att + e26*e2_e6_att)
            new_e3 = x2ms_adapter.mm(e3, self.W2) + x2ms_adapter.tanh(e31*e3_e1_att + e32*e3_e2_att + e34*e3_e4_att + e35*e3_e5_att + e36*e3_e6_att)
            new_e4 = x2ms_adapter.mm(e4, self.W2) + x2ms_adapter.tanh(e41*e4_e1_att + e42*e4_e2_att + e43*e4_e3_att + e45*e4_e5_att + e46*e4_e6_att)
            new_e5 = x2ms_adapter.mm(e5, self.W2) + x2ms_adapter.tanh(e51*e5_e1_att + e52*e5_e2_att + e53*e5_e3_att + e54*e5_e4_att + e56*e5_e6_att)
            new_e6 = x2ms_adapter.mm(e6, self.W2) + x2ms_adapter.tanh(e61*e6_e1_att + e62*e6_e2_att + e63*e6_e3_att + e64*e6_e4_att + e65*e6_e5_att)

            e = new_e1 * new_e2 * new_e3 * new_e4 * new_e5 * new_e6 * r


        elif batch.shape[1] == 8:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re1_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re2_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re3_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re4_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re5_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re6_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            re7_att = x2ms_adapter.exp(self.leakyrelu(re7)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att
            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e1_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e1_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e1_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e2_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e2_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e2_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e3_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e3_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e3_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e4_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e4_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e4_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))))
            e5_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e5_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e5_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e5_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e5_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e5_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))))
            e6_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e6_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e6_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e6_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e6_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e6_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))))
            e7_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))
            e7_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))
            e7_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))
            e7_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))
            e7_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))
            e7_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))))

            e1 = x2ms_adapter.mm(x2ms_adapter.cat((e1, x2ms_adapter.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att)), dim=1), self.W0)
            e2 = x2ms_adapter.mm(x2ms_adapter.cat((e2, x2ms_adapter.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att)), dim=1), self.W0)
            e3 = x2ms_adapter.mm(x2ms_adapter.cat((e3, x2ms_adapter.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att)), dim=1), self.W0)
            e4 = x2ms_adapter.mm(x2ms_adapter.cat((e4, x2ms_adapter.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att)), dim=1), self.W0)
            e5 = x2ms_adapter.mm(x2ms_adapter.cat((e5, x2ms_adapter.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att)), dim=1), self.W0)
            e6 = x2ms_adapter.mm(x2ms_adapter.cat((e6, x2ms_adapter.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att)), dim=1), self.W0)
            e7 = x2ms_adapter.mm(x2ms_adapter.cat((e7, x2ms_adapter.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att)), dim=1), self.W0)
            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7



        elif batch.shape[1] == 9:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re1_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re2_att = x2ms_adapter.exp(self.leakyrelu(re2)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re3_att = x2ms_adapter.exp(self.leakyrelu(re3)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re4_att = x2ms_adapter.exp(self.leakyrelu(re4)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re5_att = x2ms_adapter.exp(self.leakyrelu(re5)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re6_att = x2ms_adapter.exp(self.leakyrelu(re6)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re7_att = x2ms_adapter.exp(self.leakyrelu(re7)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            re8_att = x2ms_adapter.exp(self.leakyrelu(re8)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att
            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e1_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e2_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e3_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e4_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))))
            e5_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e5_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))))
            e6_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e6_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))))
            e7_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e7_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))))
            e8_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))
            e8_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))))

            e1 = x2ms_adapter.mm(x2ms_adapter.cat((e1, x2ms_adapter.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att)), dim=1), self.W0)
            e2 = x2ms_adapter.mm(x2ms_adapter.cat((e2, x2ms_adapter.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att)), dim=1), self.W0)
            e3 = x2ms_adapter.mm(x2ms_adapter.cat((e3, x2ms_adapter.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att)), dim=1), self.W0)
            e4 = x2ms_adapter.mm(x2ms_adapter.cat((e4, x2ms_adapter.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att)), dim=1), self.W0)
            e5 = x2ms_adapter.mm(x2ms_adapter.cat((e5, x2ms_adapter.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att)), dim=1), self.W0)
            e6 = x2ms_adapter.mm(x2ms_adapter.cat((e6, x2ms_adapter.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att)), dim=1), self.W0)
            e7 = x2ms_adapter.mm(x2ms_adapter.cat((e7, x2ms_adapter.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att)), dim=1), self.W0)
            e8 = x2ms_adapter.mm(x2ms_adapter.cat((e8, x2ms_adapter.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8


        elif batch.shape[1] == 10:
            e1 = self.E(batch[:, 1])
            e2 = self.E(batch[:, 2])
            e3 = self.E(batch[:, 3])
            e4 = self.E(batch[:, 4])
            e5 = self.E(batch[:, 5])
            e6 = self.E(batch[:, 6])
            e7 = self.E(batch[:, 7])
            e8 = self.E(batch[:, 8])
            e9 = self.E(batch[:, 9])
            # re1 = torch.matmul(self.er_pos_emb(r, e1), self.W)
            # re2 = torch.matmul(self.er_pos_emb(r, e2), self.W)
            # re3 = torch.matmul(self.er_pos_emb(r, e3), self.W)
            # re4 = torch.matmul(self.er_pos_emb(r, e4), self.W)
            # re5 = torch.matmul(self.er_pos_emb(r, e5), self.W)
            # re6 = torch.matmul(self.er_pos_emb(r, e6), self.W)
            # re7 = torch.matmul(self.er_pos_emb(r, e7), self.W)
            # re8 = torch.matmul(self.er_pos_emb(r, e8), self.W)
            # re9 = torch.matmul(self.er_pos_emb(r, e9), self.W)
            re1 = self.er_pos_emb(r, e1)
            re2 = self.er_pos_emb(r, e2)
            re3 = self.er_pos_emb(r, e3)
            re4 = self.er_pos_emb(r, e4)
            re5 = self.er_pos_emb(r, e5)
            re6 = self.er_pos_emb(r, e6)
            re7 = self.er_pos_emb(r, e7)
            re8 = self.er_pos_emb(r, e8)
            re9 = self.er_pos_emb(r, e9)
            re1_att = x2ms_adapter.exp(self.leakyrelu(re1)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re2_att = x2ms_adapter.exp(self.leakyrelu(re2)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re3_att = x2ms_adapter.exp(self.leakyrelu(re3)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re4_att = x2ms_adapter.exp(self.leakyrelu(re4)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re5_att = x2ms_adapter.exp(self.leakyrelu(re5)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re6_att = x2ms_adapter.exp(self.leakyrelu(re6)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re7_att = x2ms_adapter.exp(self.leakyrelu(re7)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re8_att = x2ms_adapter.exp(self.leakyrelu(re8)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            re9_att = x2ms_adapter.exp(self.leakyrelu(re9)) / (x2ms_adapter.exp(self.leakyrelu(re1)) + x2ms_adapter.exp(self.leakyrelu(re2)) + x2ms_adapter.exp(self.leakyrelu(re3)) + x2ms_adapter.exp(self.leakyrelu(re4)) + x2ms_adapter.exp(self.leakyrelu(re5)) + x2ms_adapter.exp(self.leakyrelu(re6)) + x2ms_adapter.exp(self.leakyrelu(re7)) + x2ms_adapter.exp(self.leakyrelu(re8)) + x2ms_adapter.exp(self.leakyrelu(re9)))
            r = re1 * re1_att + re2 * re2_att + re3 * re3_att + re4 * re4_att + re5 * re5_att + re6 * re6_att + re7 * re7_att + re8 * re8_att + re9 * re9_att
            e1_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e1_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e1, e9), dim=1), self.a))))
            e2_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e2_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e2, e9), dim=1), self.a))))
            e3_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e3_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e3, e9), dim=1), self.a))))
            e4_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e4_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e4, e9), dim=1), self.a))))
            e5_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e5_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e5, e9), dim=1), self.a))))
            e6_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e6_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e6, e9), dim=1), self.a))))
            e7_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e7_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e8), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e7, e9), dim=1), self.a))))
            e8_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e8_e9_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e8, e9), dim=1), self.a))))
            e9_e1_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e2_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e3_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e4_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e5_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e6_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e7_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))
            e9_e8_att = x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))) / (x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e1), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e2), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e3), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e4), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e5), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e6), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e7), dim=1), self.a))) + x2ms_adapter.exp(self.leakyrelu(x2ms_adapter.mm(x2ms_adapter.cat((e9, e8), dim=1), self.a))))

            e1 = x2ms_adapter.mm(x2ms_adapter.cat((e1, x2ms_adapter.tanh(e2*e1_e2_att + e3*e1_e3_att + e4*e1_e4_att + e5*e1_e5_att + e6*e1_e6_att + e7*e1_e7_att + e8*e1_e8_att + e9*e1_e9_att)), dim=1), self.W0)
            e2 = x2ms_adapter.mm(x2ms_adapter.cat((e2, x2ms_adapter.tanh(e1*e2_e1_att + e3*e2_e3_att + e4*e2_e4_att + e5*e2_e5_att + e6*e2_e6_att + e7*e2_e7_att + e8*e2_e8_att + e9*e2_e9_att)), dim=1), self.W0)
            e3 = x2ms_adapter.mm(x2ms_adapter.cat((e3, x2ms_adapter.tanh(e1*e3_e1_att + e2*e3_e2_att + e4*e3_e4_att + e5*e3_e5_att + e6*e3_e6_att + e7*e3_e7_att + e8*e3_e8_att + e9*e3_e9_att)), dim=1), self.W0)
            e4 = x2ms_adapter.mm(x2ms_adapter.cat((e4, x2ms_adapter.tanh(e1*e4_e1_att + e2*e4_e2_att + e3*e4_e3_att + e5*e4_e5_att + e6*e4_e6_att + e7*e4_e7_att + e8*e4_e8_att + e9*e4_e9_att)), dim=1), self.W0)
            e5 = x2ms_adapter.mm(x2ms_adapter.cat((e5, x2ms_adapter.tanh(e1*e5_e1_att + e2*e5_e2_att + e3*e5_e3_att + e4*e5_e4_att + e6*e5_e6_att + e7*e5_e7_att + e8*e5_e8_att + e9*e5_e9_att)), dim=1), self.W0)
            e6 = x2ms_adapter.mm(x2ms_adapter.cat((e6, x2ms_adapter.tanh(e1*e6_e1_att + e2*e6_e2_att + e3*e6_e3_att + e4*e6_e4_att + e5*e6_e5_att + e7*e6_e7_att + e8*e6_e8_att + e9*e6_e9_att)), dim=1), self.W0)
            e7 = x2ms_adapter.mm(x2ms_adapter.cat((e7, x2ms_adapter.tanh(e1*e7_e1_att + e2*e7_e2_att + e3*e7_e3_att + e4*e7_e4_att + e5*e7_e5_att + e6*e7_e6_att + e8*e7_e8_att + e9*e7_e9_att)), dim=1), self.W0)
            e8 = x2ms_adapter.mm(x2ms_adapter.cat((e8, x2ms_adapter.tanh(e1*e8_e1_att + e2*e8_e2_att + e3*e8_e3_att + e4*e8_e4_att + e5*e8_e5_att + e6*e8_e6_att + e7*e8_e7_att + e9*e8_e9_att)), dim=1), self.W0)
            e9 = x2ms_adapter.mm(x2ms_adapter.cat((e9, x2ms_adapter.tanh(e1*e9_e1_att + e2*e9_e2_att + e3*e9_e3_att + e4*e9_e4_att + e5*e9_e5_att + e6*e9_e6_att + e7*e9_e7_att + e8*e9_e8_att)), dim=1), self.W0)

            e = r * e1 * e2 * e3 * e4 * e5 * e6 * e7 * e8 * e9


        x = e
        x = self.hidden_drop(x)
        return x2ms_adapter.x2ms_sum(x, dim=1)



